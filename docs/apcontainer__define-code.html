<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Fri Mar  6 15:42:38 2015 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>apcontainer__define.pro (Documentation for /Users/aram/git/APlib/core/)</title>

    
    <link rel="stylesheet" type="text/css" media="all"
          href="idldoc-resources/main.css" />
    <link rel="stylesheet" type="text/css" media="print"
          href="idldoc-resources/main-print.css" />
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="apcontainer__define.pro (Documentation for /Users/aram/git/APlib/core/)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">
    <div class="content">
      <code class="source"><span class="comments">;==============================================================================</span>
<span class="comments">; :: APDICTIONARY ::</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">; This class is essentially a dictionary class that allows for very quick</span>
<span class="comments">; field value setting. </span>
<span class="comments">;</span>
<span class="comments">; :Author:</span>
<span class="comments">;    Aram Panasenco (panasencoaram@gmail.com)</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::INIT</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">;  Initializes an apDictionary object.</span>
<span class="comments">;</span>
<span class="comments">; :Examples:</span>
<span class="comments">;    IDL> mydict = obj_new('apDictionary', strkey='hi', intkey=-3, objkey=obj_new())</span>
<span class="comments">;</span>
<span class="comments">; :Returns:</span>
<span class="comments">;    Boolean success value (1/0)</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    _EXTRA : required</span>
<span class="comments">;      Keywords of the format FIELDNAME=VALUE. These define the initial class</span>
<span class="comments">;      structure.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::init:source"></a>function apDictionary::init, _EXTRA=initStruct
	self.pContainer = ptr_new(/allocate_heap)
	self -> add, _extra=initStruct
	return, 1B
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::ADD</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">;  Adds (multiple) field names and values.</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    _EXTRA : required</span>
<span class="comments">;      Keywords of the format FIELDNAME=VALUE. The field names and values to</span>
<span class="comments">;      add to the structure. If some of the fieldnames are already defined in</span>
<span class="comments">;      the structure, they are overwritten.</span>
<span class="comments">;    SUCCESS : optional, type=boolean</span>
<span class="comments">;      Optional variable to store the success boolean flag.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::add:source"></a>pro apDictionary::add, _extra=addStruct, SUCCESS=successBool
	
	<span class="comments">;Check if any field values were passed</span>
	if (n_elements(addStruct) eq 0) then begin
		successBool = 0B
		return
	endif
	
	<span class="comments">;Check if the container is not empty</span>
	if (n_elements(*self.pContainer) ne 0) then begin
		<span class="comments">;Get the names of the fields being added and the already existing fields</span>
		addNames = tag_names(addStruct)
		curNames = tag_names(*self.pContainer)
		<span class="comments">;Remove all fields where the names are duplicate</span>
		for i=0, n_elements(addNames)-1 do begin
			dupIndex = (where(curNames eq addNames))[0]
			if (dupIndex ne -1) then self -> _remove, dupIndex
		endfor
		<span class="comments">;Check if the container didn't get entirely deleted in the removal process</span>
		if (n_elements(*self.pContainer) ne 0) then begin
			*self.pContainer = create_struct(*self.pContainer, addStruct)
		endif else begin
			*self.pContainer = addStruct
		endelse
	endif else begin
		*self.pContainer = addStruct
	endelse
	
	successBool = 1B
	return
	
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::_REMOVE</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">;  Removes (multiple) field names from the container.</span>
<span class="comments">;</span>
<span class="comments">; :Private:</span>
<span class="comments">;</span>
<span class="comments">; :Params:</span>
<span class="comments">;    indices : required</span>
<span class="comments">;      An array of indices of the container field names to be removed.</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    SUCCESS : optional, type=boolean</span>
<span class="comments">;      Optional variable to store the success boolean flag.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::_remove:source"></a>pro apDictionary::_remove, indices, SUCCESS=successBool
	
	successBool = 0B
	if (n_elements(indices) eq 0 or n_elements(*self.pContainer) eq 0) then return
	
	<span class="comments">;Get the number of elements and the tag names of the internal container</span>
	nContainer = n_tags(*self.pContainer)
	tContainer = tag_names(*self.pContainer)
	
	<span class="comments">;Create a new container structure from scratch, not including the specified indices</span>
	for i=0, nContainer-1 do begin
		if ((where(indices eq i))[0] eq -1) then begin
			if (n_elements(newContainer) ne 0) then begin
				newContainer = create_struct(tContainer[i],(*self.pContainer).(i),newContainer)
			endif else begin
				newContainer = create_struct(tContainer[i],(*self.pContainer).(i))
			endelse
		endif
	endfor
	
	if (n_elements(newContainer) ne 0) then begin
		<span class="comments">;Set the new container</span>
		*self.pContainer = newContainer
	endif else begin
		<span class="comments">;Set the container to an empty pointer</span>
		self.pContainer = ptr_new(/allocate_heap)
	endelse
	
	<span class="comments">;Set the success boolean to true and return</span>
	successBool = 1B
	return
	
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::SET</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">;  Sets (multiple) field values.</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    _EXTRA : required</span>
<span class="comments">;      Keywords of the format FIELDNAME=VALUE. The field names have to</span>
<span class="comments">;      correspond to those of the class structure (not case-sensitive).</span>
<span class="comments">;    SUCCESS : optional, type=boolean</span>
<span class="comments">;      Optional variable to store the success boolean flag.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::set:source"></a>pro apDictionary::set, _extra=fieldStruct, SUCCESS=successBool
	
	<span class="comments">;Define the successBool to be 0B (false) by default</span>
	successBool = 0B
	
	<span class="comments">;Check if no field values were passed or no container exists</span>
	if (n_elements(fieldStruct) eq 0 or n_elements(*self.pContainer) eq 0) then return
	
	<span class="comments">;Get the names of the fields being set</span>
	fieldArray = tag_names(fieldStruct)
	
	<span class="comments">;Loop through the field names in the field structure</span>
	for fieldIndex=0, n_elements(fieldArray)-1 do begin
		
		fieldName = fieldArray[fieldIndex]
		
		<span class="comments">;Get the index of the matching field in the container structure</span>
		matchArray = strcmp(tag_names(*self.pContainer), fieldName, /fold_case)
		containerIndex = (where(matchArray eq 1))[0]
		
		if (containerIndex eq -1) then begin
			<span class="comments">;No match, start the next iteration</span>
			continue
		endif
		
		<span class="comments">;Set the field</span>
		(*self.pContainer).(containerIndex) = fieldStruct.(fieldIndex)
		successBool = 1B
		
	endfor
	
	<span class="comments">;If none of the values have been set, successBool will be 0B</span>
	<span class="comments">;If any of the values have been set, successBool will be 1B</span>
	return
	
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::GET</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">; Retrieves a field value.</span>
<span class="comments">;</span>
<span class="comments">; :Returns:</span>
<span class="comments">;    The value of the field.</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    _EXTRA : required</span>
<span class="comments">;      Keyword of the format /FIELDNAME. The field name has to</span>
<span class="comments">;      correspond to the name of a field in the class structure</span>
<span class="comments">;      (not case-sensitive).</span>
<span class="comments">;    SUCCESS : optional, type=boolean</span>
<span class="comments">;      Optional variable to store the success boolean flag.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::get:source"></a>function apDictionary::get, _extra=fieldStruct, SUCCESS=successBool
	
	<span class="comments">;Define the successBool to be 0B (false) by default</span>
	successBool = 0B
	<span class="comments">;Value to be returned if the get is unsuccessful</span>
	NULL_RETURN_VALUE = -1
	
	<span class="comments">;Check if more/less than one field name was passed or no container exists</span>
	if (n_elements(fieldStruct) ne 1 or n_elements(*self.pContainer) eq 0) then $
	 return, NULL_RETURN_VALUE
	
	<span class="comments">;Get the name of the field being retirved</span>
	fieldName = (tag_names(fieldStruct))[0]
	
	<span class="comments">;Get the index of the matching field in the class structure</span>
	matchArray = strcmp(tag_names(*self.pContainer), fieldName, /fold_case)
	containerIndex = (where(matchArray eq 1))[0]
	
	<span class="comments">;If no match, return unsuccessfully</span>
	if (containerIndex eq -1) then return, NULL_RETURN_VALUE
	
	successBool = 1B
	return, (*self.pContainer).(containerIndex)
	
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::DUPLICATE</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">;</span>
<span class="comments">;    Creates a duplicate of the container</span>
<span class="comments">;</span>
<span class="comments">; :Returns:</span>
<span class="comments">;    A new container object identical to this one.</span>
<span class="comments">;</span>
<span class="comments">; :Keywords:</span>
<span class="comments">;    SUCCESS : optional, type=boolean</span>
<span class="comments">;      Optional variable to store the success boolean flag.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::duplicate:source"></a>function apDictionary::duplicate, SUCCESS=successBool
	dupObject = obj_new('apDictionary', _extra=(*self.pContainer))
	successBool = obj_valid(dupObject)
	return, dupObject
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY::CLEANUP</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">; :Hidden:</span>
<span class="comments">;</span>
<span class="comments">; :Description:</span>
<span class="comments">;    Cleanup procedure for the apDictionary class</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary::cleanup:source"></a>pro apDictionary::cleanup
	<span class="comments">;Free the internal data pointer</span>
	ptr_free, self.pContainer
end


<span class="comments">;==============================================================================</span>
<span class="comments">;    APDICTIONARY__DEFINE</span>
<span class="comments">;+=============================================================================</span>
<span class="comments">; :Hidden:</span>
<span class="comments">;</span>
<span class="comments">; :Description:</span>
<span class="comments">;    Definition procedure for the apDictionary class.</span>
<span class="comments">;</span>
<span class="comments">;-=============================================================================</span>
<a id="apDictionary__define:source"></a>pro apDictionary__define
	class = { $
		apDictionary, $
		pContainer: ptr_new() $
	}
end
</code>
    </div>
  </body>
</html>